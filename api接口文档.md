## 1.1. API 接口说明

- **报修前台**与**管理系统**公用一个后台
- **报修前台**接口基准地址：`http://127.0.0.1:3000/api/report/v1/`
- **管理系统**接口基准地址：`http://127.0.0.1:3000/api/admin/v1/`
- 服务端已开启 CORS 跨域支持
- 数据返回格式统一使用 JSON
- 数据库配置在 util 目录下的 `dbconfig.js` 文件中

### 1.1.1. 支持的请求方法

- GET（SELECT）：从服务器取出资源（一项或多项）。
- POST（CREATE）：在服务器新建一个资源。
- PUT（UPDATE）：在服务器更新资源（客户端提供改变后的完整资源）。
- PATCH（UPDATE）：在服务器更新资源（客户端提供改变的属性）。
- DELETE（DELETE）：从服务器删除资源。
- HEAD：获取资源的元数据。
- OPTIONS：获取信息，关于资源的哪些属性是客户端可以改变的。

### 1.1.2. 通用返回状态说明

| _状态码_ | _含义_                | _说明_                                              |
| -------- | --------------------- | --------------------------------------------------- |
| 200      | OK                    | 请求成功                                            |
| 201      | CREATED               | 创建成功                                            |
| 204      | DELETED               | 删除成功                                            |
| 400      | BAD REQUEST           | 请求的地址不存在或者包含不支持的参数                |
| 401      | UNAUTHORIZED          | 未授权                                              |
| 403      | FORBIDDEN             | 被禁止访问                                          |
| 404      | NOT FOUND             | 请求的资源不存在                                    |
| 422      | Unprocesable entity   | [POST/PUT/PATCH] 当创建一个对象时，发生一个验证错误 |
| 500      | INTERNAL SERVER ERROR | 内部错误                                            |





## 1.2. 报修前台（report接口）

### 1.2.1. 用户提交报修

- 请求路径：report
- 请求方法：post
- 请求参数

| 参数名      | 参数说明 | 备注     |
| ----------- | -------- | -------- |
| u_name      | 用户名字 | 不能为空 |
| u_phone     | 用户电话 | 不能为空 |
| u_identity  | 用户身份 | 不能为空 |
| address     | 报修地址 | 不能为空 |
| des_address | 详细地址 | 不能为空 |
| pic         | 上传图片 | 可以为空 |
| reason      | 具体原因 | 不能为空 |
| c_time      | 创建时间 | 不能为空 |
| state       | 当前状态 | 不能为空 |

- 响应参数

| 参数名  | 参数说明 | 备注     |
| ------- | -------- | -------- |
| status  | 用户名字 | 状态码   |
| message | 用户电话 | 提示消息 |



### 1.2.1. 用户报修记录

- 此接口用于用户查询自己报修过的记录
- 请求路径：report
- 请求方法：get
- 请求参数

| 参数名  | 参数说明 | 备注     |
| ------- | -------- | -------- |
| u_phone | 用户电话 | 不能为空 |

- 响应参数

| 参数名  | 参数说明 | 备注     |
| ------- | -------- | -------- |
| status  | 用户名字 | 状态码   |
| message | 用户电话 | 提示消息 |



## 1.3. 管理系统（admin）

### 1.3.1.  登录接口

- 请求路径：login
- 请求方法：post
- 请求参数

| 参数名   | 参数说明 | 备注     |
| -------- | -------- | -------- |
| username | 用户名   | 不能为空 |
| password | 密码     | 不能为空 |

- 响应参数

| 参数名   | 参数说明 | 备注            |
| -------- | -------- | --------------- |
| username | 用户名   |                 |
| token    | 令牌     | 基于 jwt 的令牌 |



### 1.3.2.  报修记录列表

- 请求路径：record
- 请求方法：get
- 请求参数
- 搜索记录也是此接口，只需要填写query参数即可。
- 查询参数（query）的值为对象，只能有一个属性，属性名只能是：u_name || u_mobile || address

| 参数名      | 参数说明     | 备注     |
| ----------- | ------------ | -------- |
| query       | 查询参数     | 可以为空 |
| currentpage | 当前页码     | 不能为空 |
| pagesize    | 每页显示条数 | 不能为空 |

- 响应参数

| 参数名      | 参数说明         | 备注 |
| ----------- | ---------------- | ---- |
| totalpage   | 总记录数         |      |
| currentpage | 当前页码         |      |
| record      | 报修记录数据集合 |      |



### 1.3.4. 删除单条记录

- 请求路径：record/:id
- 请求方法：delete
- 请求参数

| 参数名 | 参数说明 | 备注                       |
| ------ | -------- | -------------------------- |
| id     | 用户 id  | 不能为空`参数是url参数:id` |

- 响应参数
- 响应数据

```js
{
    "data": null,
    "msg": "删除成功",
    "status": 200
}
```



### 1.3.4. 根据 ID 查询用户信息

- 请求路径：record/:id
- 请求方法：get
- 请求参数

| 参数名 | 参数说明 | 备注                       |
| ------ | -------- | -------------------------- |
| id     | 用户 id  | 不能为空`参数是url参数:id` |
